FROM brisedev/worker-dev:2.6.0

# Copying project
COPY . /root
RUN rm /root/Dockerfile

WORKDIR /root

ARG BRISE_EVENT_SERVICE_HOST
ENV BRISE_EVENT_SERVICE_HOST=${BRISE_EVENT_SERVICE_HOST}

ARG BRISE_EVENT_SERVICE_AMQP_PORT
ENV BRISE_EVENT_SERVICE_AMQP_PORT=${BRISE_EVENT_SERVICE_AMQP_PORT}

ARG BRISE_EVENT_SERVICE_GUI_PORT
ENV BRISE_EVENT_SERVICE_GUI_PORT=${BRISE_EVENT_SERVICE_GUI_PORT}

ARG BRISE_DATABASE_HOST
ENV BRISE_DATABASE_HOST=${BRISE_DATABASE_HOST}

ARG BRISE_DATABASE_PORT
ENV BRISE_DATABASE_PORT=${BRISE_DATABASE_PORT}

ARG BRISE_DATABASE_NAME
ENV BRISE_DATABASE_NAME=${BRISE_DATABASE_NAME}

ARG BRISE_DATABASE_USER
ENV BRISE_DATABASE_USER=${BRISE_DATABASE_USER}

ARG BRISE_DATABASE_PASS
ENV BRISE_DATABASE_PASS=${BRISE_DATABASE_PASS}

CMD conda init bash && \
    . ~/.bashrc && \
    conda activate brise-260 && \
    dockerize -wait http://${BRISE_EVENT_SERVICE_HOST}:${BRISE_EVENT_SERVICE_GUI_PORT}  python3.12 -u w_intro.py
